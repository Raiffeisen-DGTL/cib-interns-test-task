# Веб-сервис для автоматизации учёта носков на складе магазина

### Возможности сервиса:
* учёт прихода на склад новых носков;
* учёт отпуска носков со склада;
* запрос общего количества всех носков на складе;
* запрос количества носков на складе по заданному цвету;
* запрос количества носков по заданному содержанию хлопка, в процентах;
* допускается как одиночное использование параметров запроса, так и их комбинация.

### Основные используемые технологии:
* SpringBoot: Web, JPA (Hibernate), Test, Validation;
* Liquibase для версионирования и генерации схемы;
* MySQL 8.x;
* Docker compose для сборки образа и поднятия приложения с БД в контейнерах;
* Lombok;

Приложение доступно в [Heroku](https://rareart-socks-demo.herokuapp.com/api/socks) и использует ClearDB.


## Список URL HTTP-методов

### POST /api/socks/income

Регистрирует приход носков на склад.

Параметры запроса передаются в теле запроса в виде JSON-объекта со следующими атрибутами:

* color — цвет носков, строка (например, black, red, yellow);
* cottonPart — процентное содержание хлопка в составе носков, целое число от 0 до 100 (например, 30, 18, 42);
* quantity — количество пар носков, целое число больше 0.


Пример тела HTTP-запроса:
```
{
    "color": "black",
    "cottonPart": 37,
    "quantity": 2
}
```

Результаты:

* HTTP 200 (OK) — удалось добавить приход;
* HTTP 400 (Bad Request) — параметры запроса отсутствуют или имеют некорректный формат;
* HTTP 500 (Internal Server Error) — произошла ошибка, не зависящая от вызывающей стороны (например, база данных недоступна).

### POST /api/socks/outcome

Регистрирует отпуск носков со склада. Здесь параметры и результаты аналогичные, но общее количество носков указанного
цвета и состава не увеличивается, а уменьшается.

### GET /api/socks

Возвращает общее количество носков на складе, соответствующих переданным в параметрах критериям запроса.

Параметры запроса передаются в URL:

* color — цвет носков, строка;
* operation — оператор сравнения значения количества хлопка в составе носков, одно значение из: moreThan, lessThan,
  equal;
* cottonPart — значение процента хлопка в составе носков из сравнения.

Результаты:

* HTTP 200 (OK) — запрос выполнен, результат в теле ответа в виде строкового представления целого числа;
* HTTP 400 (Bad Request) — параметры запроса отсутствуют или имеют некорректный формат;
* HTTP 500 (Internal Server Error) — произошла ошибка, не зависящая от вызывающей стороны (например, база данных недоступна).

Примеры запросов:

* https://rareart-socks-demo.herokuapp.com/api/socks?color=red&operation=moreThan&cottonPart=90 — должен вернуть общее количество красных носков с долей хлопка
  более 90%;
* https://rareart-socks-demo.herokuapp.com/api/socks?color=black&operation=lessThan&cottonPart=10 — должен вернуть общее количество черных носков с долей хлопка
  менее 10%.

Для хранения данных системы использована реляционная БД MySQL. Схема БД хранится по пути src/main/resources/reference_schema.sql, а так же описана в changelog'e Liquibase.
